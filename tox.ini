[tox]
envlist = py37, py38, py39, py310, docs
skipsdist = true

[gh-actions]
python =
    3.7: py37
    3.8: py38, docs
    3.9: py39
    3.10: py310

[testenv:docs]
basepython=python
allowlist_externals =
    mkdocs
    pdbpp
    rm
commands_pre = poetry install -E docs
commands=
    poetry run mkdocs build
    rm -rf site

[testenv]
allowlist_externals = pdbpp
extras =
    dev
deps =
    poetry
setenv =
    PYTHONPATH = {toxinidir}
commands_pre = poetry install -E test
commands = poetry run pytest -s --cov-report=term-missing tests

[flake8]
max-line-length = 119
ignore =
    # do not assign a lambda expression, use a def
    E731
    # black handles following errors:
    E101
    E111
    E114
    E115
    E116
    E117
    E121
    E122
    E123
    E124
    E125
    E126
    E127
    E128
    E129
    E131
    E133
    E2
    E3
    E5
    E701
    E702
    E703
    E704
    W1
    W2
    W3
    W503
    W504
exclude =
    # git directory
    .git,
    # python artifacts
    __pycache__,
    # test artifacts
    .tox,
    # built artifacts
    build,
    dist,
    .eggs,
